<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Начать</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>

<body style="
  background:#0f172a;
  color:#e5e7eb;
  font-family: Arial, sans-serif;
  padding:20px;
">

<h2 style="margin-top:0;">Начать</h2>

<p style="color:#cbd5f5; line-height:1.6;">
Здесь можно начать диалог со мной и разобраться:
<br>— нужен ли вам ментор
<br>— формат консультации
<br>— помощь с резюме
</p>

<hr style="border-color:#334155; margin:20px 0;">

<form id="form">

  <input
    id="name"
    placeholder="Ваше имя"
    required
    style="
      width:100%;
      padding:10px;
      margin-bottom:10px;
      background:#020617;
      border:1px solid #334155;
      color:#e5e7eb;
      border-radius:8px;
    "
  >

  <select
    id="type"
    style="
      width:100%;
      padding:10px;
      margin-bottom:14px;
      background:#020617;
      border:1px solid #334155;
      color:#e5e7eb;
      border-radius:8px;
    "
  >
    <option>Подбор ментора</option>
    <option>Консультация</option>
    <option>Резюме</option>
  </select>

  <button
    type="submit"
    style="
      width:100%;
      padding:12px;
      font-size:16px;
      background:#6366f1;
      color:white;
      border:none;
      border-radius:10px;
      cursor:pointer;
    "
  >
    Начать диалог
  </button>

</form>

<p style="margin-top:12px;color:#94a3b8;">
После нажатия откроется чат со мной в Telegram.
</p>

<script>
const OWNER = "Grader_vi"; // твой username БЕЗ @

// 1) Автоподстановка из Telegram
let autoContact = "";
try {
  const tg = window.Telegram?.WebApp;
  if (tg) {
    tg.ready();
    const user = tg.initDataUnsafe?.user;

    // имя подставим в поле
    if (user?.first_name) {
      const nameEl = document.getElementById("name");
      if (nameEl && !nameEl.value) nameEl.value = user.first_name;
    }

    // контакт для заявки
    if (user?.username) autoContact = "@" + user.username;
    else if (user?.id) autoContact = "TG ID: " + user.id;
  }
} catch (e) {}

document.getElementById("form").onsubmit = function(e) {
  e.preventDefault();

  const name = document.getElementById("name").value;
  const type = document.getElementById("type").value;

  const message =
`Новая заявка

Запрос: ${type}
Имя: ${name}
Контакт: ${autoContact || "не определён"}

Начинаем диалог.`;

  const url = "https://t.me/" + OWNER + "?text=" + encodeURIComponent(message);

  if (window.Telegram?.WebApp?.openTelegramLink) {
    Telegram.WebApp.openTelegramLink(url);
  } else {
    window.open(url, "_blank");
  }
};
</script>

</body>
</html>
